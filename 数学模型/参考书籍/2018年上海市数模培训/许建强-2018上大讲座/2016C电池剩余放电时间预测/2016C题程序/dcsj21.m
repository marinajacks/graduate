clear
x=xlsread('c:\MATLAB7\work\CUMCM2016-C-Appendix-Chinese.xls','附件2','a3:e150');
x1=x(:,1);
y=x(:,5);
beta0=[10,10,30];
[beta,R,J]=nlinfit(x1,y,'dcsj11',beta0);
x2=[ones(size(x,1),1),x(:,2:4)];
[b,bint,r,rint,stats]=regress(y,x2);%线性回归
%rcoplot(r,rint);%画残差图
%x3=[x(:,2:4),x(:,2).^2,x(:,3).^2,x(:,4).^2];
%stepwise(x3,y);%逐步回归
x4=[ones(size(x,1),1),x(:,2:3),x(:,2).^2,x(:,3).^2];
[b,bint,r,rint,stats]=regress(y,x4);
qqplot(r);%画残差Q-Q图，可检验残差是否服从正态分布
x5=xlsread('c:\MATLAB7\work\CUMCM2016-C-Appendix-Chinese.xls','附件2','a151:d303');
y=b(1)+b(2)*x5(:,2)+b(3)*x5(:,3)+b(4)*x5(:,2).^2+b(5)*x5(:,3).^2;
x5=[x5,y];
x6=[x;x5];
plot(x6(:,2:5),x6(:,1))
